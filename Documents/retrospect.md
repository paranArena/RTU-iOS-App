## Contents 
- [1.04 업데이트](#104-업데이트)
	- [요구사항](#요구사항)
	- [개발 지연 사유](#개발-지연-사유)
	- [무엇을 배웠는가](#무엇을-배웠는가)
- [2.0 업데이트](#20-업데이트)
- [마무리](#마무리)

# 1.04 업데이트 

## 요구사항

기존에는 물품을 등록할 때 반드시 위치를 설정해야했다. 사용자들로부터 위치에 상관없이 물품을 대여할 수 있게해달라고 요구를 받았고 1.04에는 이 기능만 수정하기로 하였다. 

## 개발 지연 사유 

이틀이면 끝날거라고 자신했다. 학생 신분이라 시간을 온전히 프로젝트에 쓰지는 못했지만 그것을 감안하여 이틀이었다. 예상보다 시간이 오래걸렸고 테스트 코드를 작성하기 전에 잠깐 그 이유를 살펴보려고 한다. 

첫번째로 협업 기간을 고려하지 못했다. 디자이너가 피그마에서 작업을 끝낸 후 변경을 시작할 수 있는데 내 시간만 고려했다. 이번에는 백엔드에서 수정할 필요가 없었기때문에 딜레이되는 시간이 짧았지만 백엔드와 디자이너가 작업하는 시간을 모두 고려해야한다. 

두번째로 내 업무 조차도 기간을 예측하는 것이 그냥 짐작이었다. 요구 사항을 듣고 막연하게 그러면 기존에 있던 것을 옵셔널로 변경해주고 이것만 처리하면 되겠다고 생각했다. 물론 전반적으로 옵셔널 처리만 하면 됐던 것은 맞지만 몇몇 더 변경될 것들이 존재했다. 기존에는 예약(request) 후 대여 확정(apply) 순으로 api를 보내야했지만 물품의 장소가 정해지지 않은 경우 예약을 할 필요가 없었고 바로 apply를 해야한다. 아마 사전에 더 고려를 해보았어도 이런것까지는 실제 개발을 하고 알았을 것 같지만 너무 일정을 빠듯하게 가져가려고 했다. 위치 기반 서비스를 사용하는지 아닌지에 따라서 뷰의 hidden 유무가 바뀔 필요도 있었다. 

세번째는 이전의 코드가 너무 나빴다. 앱 배포를 하루이틀 앞두고서 alert나 여러 기능들이 추가되었고 팀원을 모두가 밤을 새우며 개발했었다. 이번에 수정한 부분이 이 기간에 만든 기능이었는데 재사용도 어렵고 코드도 난잡했다. 처음에는 MVVM만 사용하다가 나중에 api 통신을 위한 Service클래스를 추가했었는데 이 때 당시에는 Service 클래스도 사용하지 않았었다. 불가피하게 리팩토링을 하느라 시간이 더 소요됐다. 

## 무엇을 배웠는가

소프트웨어공학 강의에서, 예전에는 코드의 재사용성에만 집중했다면 최근에는 당연히 유연성과 확장성까지도 고려해야 한다고 들었다. 1.03 업데이트까지는 자잘한 버그의 수정이나 새로운 기능 추가만 했었기때문에 이것의 중요성을 느낄 수 없었는데 이번에 기존의 기능을 수정하는 작업을 하면서 중요성을 조금 느꼈다. 

기능을 변경하면서 기존에는 잘 동작했던 것들에 버그가 생길 수가 있고 최악의 경우에는 버그인줄도 모르는 경우도 있었다. 그리고 이것을 방지하기 위한 테스트코드의 필요성도 느꼈다.

백엔드의 DB테이블과 DTO를 알고 있는 편이 좋다. 이번에 변경해야할건 latitude, longitude를 옵셔널로 바꾸는거였다. 그리고 백엔드에서는 데이터를 아래 json 포맷으로 보내준다. 
```json 
location: { 
	name: "" 
	latitude: null 
	longitude: null 
}
``` 
이 location 타입은 물건의 정보를 가져올 때와 대여(예약)정보를 가져올 때 모두 공통적으로 사용된다. 백엔드에서는 그랬지만 나는 각 struct마다 inner class로 선언되어 있었다. Product, Rent 정보를 담는 struct에 location 구현되어 있으니 우선 product만 수정했다가 나중에 rent에서 정보를 가져오지 못하는 문제가 발생해서 두번 수정했다. 

처음부터 백엔드에서 location을 재사용하고 있었다는걸 알았다면 이런 문제는 없었을 것이다. 최소한 그냥 하나의 { } 감싸진 것을 다 개별적으로 구현하고 있어도 됐다. 내가 봤던 많은 alamofire 예제들이 inner class를 사용하고 있어서 나도 무의식적으로 사용한거 같은데 앞으로 Codable을 준수하는 구조체에 inner class 사용은 지양해야한다. 

# 2.0 업데이트 

버전 관리애 대해서 새롭게 안 사실이 있다. 1.04는 1.4로 인식된다. 1.04 패치 이후에 문제가 내부적인 로직이 약간 변경되어서 빠르게 1.041 패치를 올렸는데 이 버전이 1.41로 인식되어서 이번에 1.1로 업데이트하려는 것이 불가능했다. 불가피하게 2.0으로 버전을 올리기로 했다. 

아직 App store 심사가 완료되지는 않았지만 이번에 이미지 선택 시 앨범과 카메라를 선택적으로 고를 수 있도록하는 기능을 추가했다. 기존에는 앨범에서만 고를 수 있었다. 이 기능은 필요한 화면마다 코드를 작성한 것이 아니기때문에 나중에 수정 시 헷갈릴 것 같아서 문서를 따로 작성했다. [이곳](https://github.com/paranArena/RTU-iOS-App/blob/develop/Documents/imagePickerViewModel.md)에서 자세한 내용을 확읺할 수 있다. 

특히 기존에는 이미지 선택 후 화면에 표시하려면 두 단계를 거쳐야해서 속도가 느렸는데 일부분에서 이 문제를 수정했다. 이미지를 고르는 모든 뷰에서 이 기능을 적용해야 하고 나아가 가능하면 더 재사용할 수 있도록 수정해야한다. 

# 마무리 

2022년 12월 18일을 끝으로 서버를 종료했다. 프로젝트에 참여한 사람 중 일부는 졸업을 하거나 다른 개인적인 사유로 더 참여하지 않을 것이다. 대부분은 그래도 참여 의사가 있지만 우선은 서버 비용이 문제라 일시적으로 닫아두기로 했다. 어떤 식으로는 서버비용 문제만 해결된다면 다시 활성화될 가능성이 크다. 

이번 학기와 프로젝트를 끝내면서 지난 일들을 회고해보면 일단 우선순위를 잘 못 설정했다. 어느 순간부터 어떤 식으로든 사용자들이(주로 학생회) 사용만 하면 된다고 생각해서 거기서 요구하는 사항에 맞춰서 개발이 진행됐다. 어차피 프로젝트 규모가 커지면 있어도 괜찮은 기능들이고 새로운 기능들 추가하면서 유지보수에 어떤 문제점들이 생기는지 공부가 됐기에 나쁘지 않은 경험이었지만 Ren2U 프로젝트가 성공했는지에 초점을 맞추면 완벽한 실패라고 생각한다. 

대여 기능 조차 완벽하다고 할 수 없는데 공지사항이나 쿠폰 기능을 추가한 것은 오히려 독이됐다. 단순히 이번 학기에 하고 끝낼거면 오히려 지금처럼 하는 것이 옳았겠지만 정말 1년, 2년을 볼 프로젝트였으면 대여 기능만 완벽하게 QA를 하고 퀄리티를 높혀야 했다. 결국 서버비용이 해결된다면 나는 이 프로젝트를 현재 그대로 가지고가면 안된다고 생각한다. 갈아엎어야한다. 

우리는 학생회의 대여 사업을 완전한 무인화를 하려고했지만 일부 학생회에서는 그저 전산화 시스템을 원했다. 결국 웹은 목표했던 서비스 출시의 일주일 전부터 전체적으로 기능이 변경됐다. 출시일을 변경할 수는 없었고 만족할만한 퀄리티가 나오지 않았다. 아마 클린코드에서 본 내용인거 같은데 '다음은 없다.' 이미 한번 나쁘게 만든 결과물을 수정하는 것은 정말 어렵다. 비단 웹뿐 아니라 iOS와 안드로이드의 쿠폰 기능도 급하게 추가되어서 품질이 좋지 않다. 

내 개인적으로는 문서 작업을 일찍했으면 좋았을 것 같다. 개발하면서 전혀하지 않은 것은 아니지만 어떤 사고를 통해서 이런 아키텍처를 갖게됐고 이 계층은 어떤 식으로 사용하는지 작성해뒀다면 좋았을 것 같다. 이 문서도 첫 출시부터 3번째 업데이트까지는 회고 내용을 적지 않았다. 그 당시까지는 문서의 필요성을 잘 느끼지 못했다. 프로젝트 중 인턴 면접을 한번 보았는데 단순히 개발적인 지식이 아니라 프로젝트 과정 경험에 대한 질문이 꽤 있었다. 프로젝트를 돌이켜 본 적이 없어서 면접이 끝나고 나서야 이렇게 답할껄, 하는 아쉬움이 밀려왔다. 

대면 스터디의 필요성도 느꼈다. 가장 개발을 열심히 했을 때는 역시 개발팀이 모두 모여서 했던 시기다. 수업으로 하는 프로젝트라 그런지 직접 만나지 않는다면 강제성이 적은 것 같다. 대면으로 하던 시기가 바쁘긴 했어도 힘들진 않았고 개발에 집중하기 정말 좋았다. 10월 이후로는 이런 만남이 적었고 그만큼 프로젝트에 시간을 쏟지 않았다. 프로젝트 팀원이 아니더라도 공부할 의지가 있는 사람들을 시간을 정해서 모으면 프로젝트에 더 집중할 수 있을 것이다. 



